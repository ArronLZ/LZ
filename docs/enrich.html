<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 富集分析 | LZ 文档</title>
  <meta name="description" content="本包致力于简化生信分析流程和批量分析。目前主要为RNAseq分析流程，后期会加入其他 分析流程。" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="3 富集分析 | LZ 文档" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="本包致力于简化生信分析流程和批量分析。目前主要为RNAseq分析流程，后期会加入其他 分析流程。" />
  <meta name="github-repo" content="ArronLZ/LZ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 富集分析 | LZ 文档" />
  
  <meta name="twitter:description" content="本包致力于简化生信分析流程和批量分析。目前主要为RNAseq分析流程，后期会加入其他 分析流程。" />
  

<meta name="author" content="作者：荔枝 earth_farmer@outlook.com" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="deg.html"/>
<link rel="next" href="rnaseq_new_pipeline.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">LZ Document</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#为何阅读本书"><i class="fa fa-check"></i>为何阅读本书</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> 安装</a>
<ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html#安装r及rsudio环境"><i class="fa fa-check"></i><b>1.1</b> 安装R及Rsudio环境</a></li>
<li class="chapter" data-level="1.2" data-path="install.html"><a href="install.html#安装lz包"><i class="fa fa-check"></i><b>1.2</b> 安装LZ包</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="deg.html"><a href="deg.html"><i class="fa fa-check"></i><b>2</b> RNAseq差异分析</a>
<ul>
<li class="chapter" data-level="2.1" data-path="deg.html"><a href="deg.html#deg-mian"><i class="fa fa-check"></i><b>2.1</b> 差异分析</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="deg.html"><a href="deg.html#加载包"><i class="fa fa-check"></i><b>2.1.1</b> 加载包</a></li>
<li class="chapter" data-level="2.1.2" data-path="deg.html"><a href="deg.html#数据准备"><i class="fa fa-check"></i><b>2.1.2</b> 数据准备</a></li>
<li class="chapter" data-level="2.1.3" data-path="deg.html"><a href="deg.html#文件夹准备"><i class="fa fa-check"></i><b>2.1.3</b> 文件夹准备</a></li>
<li class="chapter" data-level="2.1.4" data-path="deg.html"><a href="deg.html#差异分析预设置"><i class="fa fa-check"></i><b>2.1.4</b> 差异分析预设置</a></li>
<li class="chapter" data-level="2.1.5" data-path="deg.html"><a href="deg.html#差异分析"><i class="fa fa-check"></i><b>2.1.5</b> 差异分析</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="deg.html"><a href="deg.html#deg-valcano"><i class="fa fa-check"></i><b>2.2</b> 火山图</a></li>
<li class="chapter" data-level="2.3" data-path="deg.html"><a href="deg.html#热图"><i class="fa fa-check"></i><b>2.3</b> 热图</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="deg.html"><a href="deg.html#热图表格数据预处理"><i class="fa fa-check"></i><b>2.3.1</b> 热图表格数据预处理</a></li>
<li class="chapter" data-level="2.3.2" data-path="deg.html"><a href="deg.html#热图分组数据预处理"><i class="fa fa-check"></i><b>2.3.2</b> 热图分组数据预处理</a></li>
<li class="chapter" data-level="2.3.3" data-path="deg.html"><a href="deg.html#选定一种算法作图"><i class="fa fa-check"></i><b>2.3.3</b> 选定一种算法作图</a></li>
<li class="chapter" data-level="2.3.4" data-path="deg.html"><a href="deg.html#循环各种聚类算法作图"><i class="fa fa-check"></i><b>2.3.4</b> 循环各种聚类算法作图</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="enrich.html"><a href="enrich.html"><i class="fa fa-check"></i><b>3</b> 富集分析</a>
<ul>
<li class="chapter" data-level="3.1" data-path="enrich.html"><a href="enrich.html#enrich-auto"><i class="fa fa-check"></i><b>3.1</b> GO &amp; KEGG 富集分析</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="enrich.html"><a href="enrich.html#一键脚本批量处理"><i class="fa fa-check"></i><b>3.1.1</b> 一键脚本(批量处理)</a></li>
<li class="chapter" data-level="3.1.2" data-path="enrich.html"><a href="enrich.html#enrich-simple"><i class="fa fa-check"></i><b>3.1.2</b> 简易GO,KEGG一次分析</a></li>
<li class="chapter" data-level="3.1.3" data-path="enrich.html"><a href="enrich.html#enrich-visual"><i class="fa fa-check"></i><b>3.1.3</b> GO、KEGG分析结果可视化</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="enrich.html"><a href="enrich.html#enrich-gsea"><i class="fa fa-check"></i><b>3.2</b> GSEA分析</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="enrich.html"><a href="enrich.html#r-gsea-批量分析"><i class="fa fa-check"></i><b>3.2.1</b> R GSEA 批量分析</a></li>
<li class="chapter" data-level="3.2.2" data-path="enrich.html"><a href="enrich.html#enrich-gsea-r.gsea.gui"><i class="fa fa-check"></i><b>3.2.2</b> R GSEA 图形界面</a></li>
<li class="chapter" data-level="3.2.3" data-path="enrich.html"><a href="enrich.html#一些进阶操作及技巧不会没有关系不做过多解释自行体会无r语言基础者慎入"><i class="fa fa-check"></i><b>3.2.3</b> 一些进阶操作及技巧(不会没有关系，不做过多解释，自行体会，无R语言基础者慎入)</a></li>
<li class="chapter" data-level="3.2.4" data-path="enrich.html"><a href="enrich.html#gsea官方软件"><i class="fa fa-check"></i><b>3.2.4</b> GSEA官方软件</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="enrich.html"><a href="enrich.html#visual"><i class="fa fa-check"></i><b>3.3</b> 转录组其它可视化</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rnaseq_new_pipeline.html"><a href="rnaseq_new_pipeline.html"><i class="fa fa-check"></i><b>4</b> RNAseq新版简化流程</a></li>
<li class="chapter" data-level="5" data-path="rnaseq-rsubread.html"><a href="rnaseq-rsubread.html"><i class="fa fa-check"></i><b>5</b> RNAseq上游分析流程</a></li>
<li class="chapter" data-level="6" data-path="multi-omics.html"><a href="multi-omics.html"><i class="fa fa-check"></i><b>6</b> 多组学</a></li>
<li class="chapter" data-level="7" data-path="cuttag.html"><a href="cuttag.html"><i class="fa fa-check"></i><b>7</b> CUT&amp;TAG</a></li>
<li class="chapter" data-level="8" data-path="scRNA.html"><a href="scRNA.html"><i class="fa fa-check"></i><b>8</b> 单细胞分析</a></li>
<li class="chapter" data-level="9" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>9</b> 空间转录组</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/ArronLZ/LZ" target="blank">编著：荔枝</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">LZ 文档</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="enrich" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> 富集分析<a href="enrich.html#enrich" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="enrich-auto" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> GO &amp; KEGG 富集分析<a href="enrich.html#enrich-auto" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="一键脚本批量处理" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 一键脚本(批量处理)<a href="enrich.html#一键脚本批量处理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>这是一个一键脚本，请新建一个单独的文件写这段脚本，然后按这个脚本的顶部注释
修改<code>resdf outd fc.list处即可</code>，运行即可批量出不同FC的富集分析结果。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="enrich.html#cb11-1" tabindex="-1"></a><span class="co"># 此脚本为GO、KEGG分析（需要一个输入文件即可，为差异分析流程后的resdf文件）</span></span>
<span id="cb11-2"><a href="enrich.html#cb11-2" tabindex="-1"></a><span class="co"># 即为第一步(或1脚本)的结果的一个结果文件（DIFF_an_***.xlsx）</span></span>
<span id="cb11-3"><a href="enrich.html#cb11-3" tabindex="-1"></a><span class="co"># 即为resdf文件，此文件是差异分析后的总表</span></span>
<span id="cb11-4"><a href="enrich.html#cb11-4" tabindex="-1"></a><span class="co"># 注意如果采用了其他的分析方法得到差异分析后表，运行这个脚本时可能需要更改</span></span>
<span id="cb11-5"><a href="enrich.html#cb11-5" tabindex="-1"></a><span class="co"># 列名即我们的resdf对象的列名为Gene, log2FC,PValue,FDR，需要与这些个列名保</span></span>
<span id="cb11-6"><a href="enrich.html#cb11-6" tabindex="-1"></a><span class="co"># 持一致。</span></span>
<span id="cb11-7"><a href="enrich.html#cb11-7" tabindex="-1"></a><span class="co"># 此脚本中的需要修改的位于 /// *** /// 行中，另外还有一个LZ::setproxy()行，</span></span>
<span id="cb11-8"><a href="enrich.html#cb11-8" tabindex="-1"></a><span class="co">#   如果没有代理工具，或者代理工具不支持http代理，或者端口不通，请不要运行。</span></span>
<span id="cb11-9"><a href="enrich.html#cb11-9" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>());<span class="fu">gc</span>() <span class="co"># 清空所有对象，慎用，必要时用</span></span>
<span id="cb11-10"><a href="enrich.html#cb11-10" tabindex="-1"></a><span class="fu">suppressMessages</span>({ <span class="fu">suppressWarnings</span>({</span>
<span id="cb11-11"><a href="enrich.html#cb11-11" tabindex="-1"></a>  <span class="fu">library</span>(LZ);<span class="fu">library</span>(YZ)</span>
<span id="cb11-12"><a href="enrich.html#cb11-12" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse);<span class="fu">library</span>(data.table)</span>
<span id="cb11-13"><a href="enrich.html#cb11-13" tabindex="-1"></a>  <span class="fu">library</span>(clusterProfiler);<span class="fu">library</span>(enrichplot)</span>
<span id="cb11-14"><a href="enrich.html#cb11-14" tabindex="-1"></a>  <span class="fu">library</span>(topGO);<span class="fu">library</span>(Rgraphviz)</span>
<span id="cb11-15"><a href="enrich.html#cb11-15" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer);<span class="fu">library</span>(ggsci);<span class="fu">library</span>(pheatmap)</span>
<span id="cb11-16"><a href="enrich.html#cb11-16" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb11-17"><a href="enrich.html#cb11-17" tabindex="-1"></a>}) })</span>
<span id="cb11-18"><a href="enrich.html#cb11-18" tabindex="-1"></a><span class="co"># 若无代理工具，切勿运行 </span></span>
<span id="cb11-19"><a href="enrich.html#cb11-19" tabindex="-1"></a><span class="co"># LZ::setproxy() # 高危！！！新手不要运行此行，会使当前窗口断网！！！</span></span>
<span id="cb11-20"><a href="enrich.html#cb11-20" tabindex="-1"></a><span class="co"># Sys.getenv(&#39;http_proxy&#39;) Sys.setenv(&#39;http_proxy&#39;=&#39;&#39;) Sys.setenv(&#39;https_proxy&#39;=&#39;&#39;)</span></span>
<span id="cb11-21"><a href="enrich.html#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="enrich.html#cb11-22" tabindex="-1"></a><span class="co"># 如果是自己提供的表格，要按需修改列名为标准的resdf格式的列名：</span></span>
<span id="cb11-23"><a href="enrich.html#cb11-23" tabindex="-1"></a><span class="co"># 即: 表格必须含列名Gene, log2FC, PValue, FDR这四列，列名必须为这四个，</span></span>
<span id="cb11-24"><a href="enrich.html#cb11-24" tabindex="-1"></a><span class="co"># 提前在xlsx中修改好，然后取消下面这句的注释符，运行</span></span>
<span id="cb11-25"><a href="enrich.html#cb11-25" tabindex="-1"></a><span class="co"># resdf &lt;- readxl::read_xlsx(&quot;result/rnaseqOR-NC/rich/DIFF.an_OR-NC.xlsx&quot;,</span></span>
<span id="cb11-26"><a href="enrich.html#cb11-26" tabindex="-1"></a><span class="co">#                  sheet = 1) %&gt;% as.data.frame()</span></span>
<span id="cb11-27"><a href="enrich.html#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="enrich.html#cb11-28" tabindex="-1"></a><span class="co"># 按流程跑下来是运行这句，注意这句和上面的注释掉的是二选一，不要重复运行</span></span>
<span id="cb11-29"><a href="enrich.html#cb11-29" tabindex="-1"></a>resdf <span class="ot">&lt;-</span> all_father<span class="sc">$</span>DIFF.ALL</span>
<span id="cb11-30"><a href="enrich.html#cb11-30" tabindex="-1"></a><span class="co"># 输出目录</span></span>
<span id="cb11-31"><a href="enrich.html#cb11-31" tabindex="-1"></a>outd <span class="ot">=</span> <span class="st">&quot;result/xx/rich&quot;</span> </span>
<span id="cb11-32"><a href="enrich.html#cb11-32" tabindex="-1"></a><span class="co"># logFC阈值, 多个阈值的话，</span></span>
<span id="cb11-33"><a href="enrich.html#cb11-33" tabindex="-1"></a><span class="co">#   写成fc.list &lt;- list(&#39;1.2&#39; = log2(1.2), &#39;2&#39; = log2(2))</span></span>
<span id="cb11-34"><a href="enrich.html#cb11-34" tabindex="-1"></a><span class="co"># 注意！！！！！！：括号里log2(2)的2，和引号里&#39;2&#39;的2都要需同步要改。！！！</span></span>
<span id="cb11-35"><a href="enrich.html#cb11-35" tabindex="-1"></a><span class="co"># 否则可能会覆盖结果 </span></span>
<span id="cb11-36"><a href="enrich.html#cb11-36" tabindex="-1"></a><span class="co"># logFC阈值, 多个阈值</span></span>
<span id="cb11-37"><a href="enrich.html#cb11-37" tabindex="-1"></a>fc.list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&#39;1.5&#39;</span> <span class="ot">=</span> <span class="fu">log2</span>(<span class="fl">1.5</span>), <span class="st">&#39;2&#39;</span> <span class="ot">=</span> <span class="fu">log2</span>(<span class="dv">2</span>), <span class="st">&#39;4&#39;</span> <span class="ot">=</span> <span class="fu">log2</span>(<span class="dv">4</span>))</span>
<span id="cb11-38"><a href="enrich.html#cb11-38" tabindex="-1"></a><span class="co"># logFC阈值, 单个阈值运行这句，也是二选一，不要重复运行</span></span>
<span id="cb11-39"><a href="enrich.html#cb11-39" tabindex="-1"></a><span class="co"># fc.list &lt;- list(&#39;2&#39;=log2(2))</span></span>
<span id="cb11-40"><a href="enrich.html#cb11-40" tabindex="-1"></a></span>
<span id="cb11-41"><a href="enrich.html#cb11-41" tabindex="-1"></a><span class="co"># 预处理数据符合GOKEGG分析的要求</span></span>
<span id="cb11-42"><a href="enrich.html#cb11-42" tabindex="-1"></a><span class="co"># # 不同fc条件下的GOgenelist list(ALL, UP, DOWN)</span></span>
<span id="cb11-43"><a href="enrich.html#cb11-43" tabindex="-1"></a>gogenelist <span class="ot">&lt;-</span> <span class="fu">lapply</span>(fc.list, <span class="cf">function</span>(x) {</span>
<span id="cb11-44"><a href="enrich.html#cb11-44" tabindex="-1"></a>  <span class="fu">DEG_prepareGOglist</span>(resdf, <span class="at">logfc =</span> x, <span class="at">p =</span> <span class="fl">0.05</span>, <span class="at">fdr =</span> <span class="fl">0.1</span>) })</span>
<span id="cb11-45"><a href="enrich.html#cb11-45" tabindex="-1"></a><span class="co"># gogenelist %&gt;% length()</span></span>
<span id="cb11-46"><a href="enrich.html#cb11-46" tabindex="-1"></a><span class="co"># 对logFC迭代，每个FC新建一个目录，用来存upgene, downgene, allgene的GO结果</span></span>
<span id="cb11-47"><a href="enrich.html#cb11-47" tabindex="-1"></a>enrich <span class="ot">&lt;-</span> <span class="fu">DEG_runENRICH</span>(<span class="at">genelist =</span> gogenelist, <span class="at">outdir =</span> outd, </span>
<span id="cb11-48"><a href="enrich.html#cb11-48" tabindex="-1"></a>                        <span class="at">glist.save =</span> T, <span class="at">rungo =</span> T, <span class="at">runkegg =</span> T, <span class="at">rapid =</span> T)</span></code></pre></div>
</div>
<div id="enrich-simple" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> 简易GO,KEGG一次分析<a href="enrich.html#enrich-simple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>如果已经得到了差异基因列表，且无需批量分析，可以进行这个简易分析。<br/>
数据格式: <code>head(genelist.lh)</code> <br/>
[1] “AARS1” “AATF” “ABCB7” “ABCE1” “ABHD11” “ABHD12”</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="enrich.html#cb12-1" tabindex="-1"></a><span class="co"># 简易GO,KEGG一次分析(即：已经得到了差异基因列表)</span></span>
<span id="cb12-2"><a href="enrich.html#cb12-2" tabindex="-1"></a><span class="co"># LZ::setproxy() # 代理设置，新手别碰，会断网</span></span>
<span id="cb12-3"><a href="enrich.html#cb12-3" tabindex="-1"></a><span class="co"># 差异基因列表</span></span>
<span id="cb12-4"><a href="enrich.html#cb12-4" tabindex="-1"></a>genelist.lh <span class="ot">&lt;-</span> pic.list<span class="sc">$</span>sig.data<span class="sc">$</span>Gene </span>
<span id="cb12-5"><a href="enrich.html#cb12-5" tabindex="-1"></a><span class="co"># 转换ID</span></span>
<span id="cb12-6"><a href="enrich.html#cb12-6" tabindex="-1"></a>gene_df <span class="ot">&lt;-</span> <span class="fu">bitr</span>(genelist.lh, <span class="at">fromType =</span> <span class="st">&quot;SYMBOL&quot;</span>, <span class="at">toType =</span> <span class="fu">c</span>(<span class="st">&quot;ENTREZID&quot;</span>, <span class="st">&quot;UNIPROT&quot;</span>), </span>
<span id="cb12-7"><a href="enrich.html#cb12-7" tabindex="-1"></a>                <span class="at">OrgDb =</span> <span class="st">&#39;org.Hs.eg.db&#39;</span>)</span>
<span id="cb12-8"><a href="enrich.html#cb12-8" tabindex="-1"></a><span class="co"># GO分析</span></span>
<span id="cb12-9"><a href="enrich.html#cb12-9" tabindex="-1"></a>go.lh <span class="ot">&lt;-</span> <span class="fu">DEG_GO</span>(gene_df, <span class="at">orgdb =</span> <span class="st">&quot;org.Hs.eg.db&quot;</span>, <span class="at">sigNodes =</span> <span class="dv">20</span>, </span>
<span id="cb12-10"><a href="enrich.html#cb12-10" tabindex="-1"></a>                <span class="at">resultdir=</span><span class="st">&quot;./result/proteinOR-NC&quot;</span>, <span class="at">filemark =</span> <span class="st">&quot;p1.5_g_2&quot;</span>)</span>
<span id="cb12-11"><a href="enrich.html#cb12-11" tabindex="-1"></a>go.lhdf <span class="ot">&lt;-</span> <span class="fu">sapply</span>(go.lh, <span class="cf">function</span>(x) x<span class="sc">@</span>result, <span class="at">simplify =</span> T)</span>
<span id="cb12-12"><a href="enrich.html#cb12-12" tabindex="-1"></a><span class="fu">write_xlsx</span>(go.lhdf, <span class="at">path =</span> <span class="st">&quot;./result/xx/lh_go.all.xlsx&quot;</span>)</span>
<span id="cb12-13"><a href="enrich.html#cb12-13" tabindex="-1"></a><span class="co"># KEGG分析</span></span>
<span id="cb12-14"><a href="enrich.html#cb12-14" tabindex="-1"></a>kegg.lh <span class="ot">&lt;-</span> <span class="fu">DEG_KEGG</span>(gene_df)</span>
<span id="cb12-15"><a href="enrich.html#cb12-15" tabindex="-1"></a><span class="fu">write_xlsx</span>(kegg.lh<span class="sc">$</span>pSigDF, <span class="at">path =</span> <span class="st">&quot;./result/xx/lh_kegg.all.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="enrich-visual" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> GO、KEGG分析结果可视化<a href="enrich.html#enrich-visual" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="enrich.html#cb13-1" tabindex="-1"></a><span class="co"># dotplot go</span></span>
<span id="cb13-2"><a href="enrich.html#cb13-2" tabindex="-1"></a><span class="co"># 读取go分析保存的表格</span></span>
<span id="cb13-3"><a href="enrich.html#cb13-3" tabindex="-1"></a><span class="co">#dotData &lt;- go$GODF$&quot;倍数&quot;$变化趋势(BP)</span></span>
<span id="cb13-4"><a href="enrich.html#cb13-4" tabindex="-1"></a><span class="co"># 自己提供表格读取</span></span>
<span id="cb13-5"><a href="enrich.html#cb13-5" tabindex="-1"></a><span class="co">#dotData &lt;- readxl::read_xlsx(&quot;kegg.xlsx&quot;, sheet = 1) </span></span>
<span id="cb13-6"><a href="enrich.html#cb13-6" tabindex="-1"></a>dotData <span class="ot">&lt;-</span> enrich<span class="sc">$</span>GODF<span class="sc">$</span><span class="st">&quot;2&quot;</span><span class="sc">$</span>all</span>
<span id="cb13-7"><a href="enrich.html#cb13-7" tabindex="-1"></a><span class="co"># 筛选数据（按需配合其他筛选）</span></span>
<span id="cb13-8"><a href="enrich.html#cb13-8" tabindex="-1"></a>pic.dot <span class="ot">&lt;-</span> <span class="fu">DEGp_Dotplot2</span>(dotData, <span class="at">head =</span> <span class="dv">20</span>, <span class="at">title =</span> <span class="st">&#39;TOP of GO&#39;</span>, </span>
<span id="cb13-9"><a href="enrich.html#cb13-9" tabindex="-1"></a>                         <span class="at">resultdir =</span> <span class="st">&quot;./result/proteinOR-NC&quot;</span>, </span>
<span id="cb13-10"><a href="enrich.html#cb13-10" tabindex="-1"></a>                         <span class="at">filemark =</span> <span class="st">&#39;GO_top&#39;</span>, <span class="at">pcompress =</span> <span class="dv">2</span>,</span>
<span id="cb13-11"><a href="enrich.html#cb13-11" tabindex="-1"></a>                         <span class="at">pic.save =</span> T)</span>
<span id="cb13-12"><a href="enrich.html#cb13-12" tabindex="-1"></a><span class="co"># dotplot kegg</span></span>
<span id="cb13-13"><a href="enrich.html#cb13-13" tabindex="-1"></a><span class="co"># 读取kegg分析保存的表格，格式要求</span></span>
<span id="cb13-14"><a href="enrich.html#cb13-14" tabindex="-1"></a><span class="co"># 必须要有这5列Description, GeneRatio, pvalue, qvalue, Count列。</span></span>
<span id="cb13-15"><a href="enrich.html#cb13-15" tabindex="-1"></a><span class="co"># 读取表格</span></span>
<span id="cb13-16"><a href="enrich.html#cb13-16" tabindex="-1"></a><span class="co"># dotDatak &lt;- readxl::read_xlsx(&quot;./result/proinOR/kegg.xlsx&quot;, sheet = 1)</span></span>
<span id="cb13-17"><a href="enrich.html#cb13-17" tabindex="-1"></a></span>
<span id="cb13-18"><a href="enrich.html#cb13-18" tabindex="-1"></a>dotDatak <span class="ot">&lt;-</span> enrich<span class="sc">$</span>KEGGDF<span class="sc">$</span><span class="st">&#39;2&#39;</span><span class="sc">$</span>up</span>
<span id="cb13-19"><a href="enrich.html#cb13-19" tabindex="-1"></a><span class="co"># 筛选数据（按需配合其他筛选）</span></span>
<span id="cb13-20"><a href="enrich.html#cb13-20" tabindex="-1"></a>pic.dotk <span class="ot">&lt;-</span> <span class="fu">DEGp_Dotplot2</span>(dotDatak, <span class="at">head =</span> <span class="dv">20</span>, <span class="at">title =</span> <span class="st">&#39;TOP of KEGGpathway&#39;</span>, </span>
<span id="cb13-21"><a href="enrich.html#cb13-21" tabindex="-1"></a>                          <span class="at">resultdir =</span> <span class="st">&quot;./result/proteinOR-NC&quot;</span>, </span>
<span id="cb13-22"><a href="enrich.html#cb13-22" tabindex="-1"></a>                          <span class="at">filemark =</span> <span class="st">&#39;KEGG_top&#39;</span>, <span class="at">pcompress =</span> <span class="dv">1</span>,</span>
<span id="cb13-23"><a href="enrich.html#cb13-23" tabindex="-1"></a>                          <span class="at">pic.save =</span> T)</span>
<span id="cb13-24"><a href="enrich.html#cb13-24" tabindex="-1"></a></span>
<span id="cb13-25"><a href="enrich.html#cb13-25" tabindex="-1"></a><span class="co"># 组合图(可选运行，比例不是很好调整，单独出图AI内调整更自由)</span></span>
<span id="cb13-26"><a href="enrich.html#cb13-26" tabindex="-1"></a>gh <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(pic.dot)</span>
<span id="cb13-27"><a href="enrich.html#cb13-27" tabindex="-1"></a>gd <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(pic.dotk)</span>
<span id="cb13-28"><a href="enrich.html#cb13-28" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(gh, gd, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>))</span>
<span id="cb13-29"><a href="enrich.html#cb13-29" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(dir_out, <span class="st">&quot;/GO_KEGG_top.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
</div>
<div id="enrich-gsea" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> GSEA分析<a href="enrich.html#enrich-gsea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="r-gsea-批量分析" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> R GSEA 批量分析<a href="enrich.html#r-gsea-批量分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><a href="https://www.gsea-msigdb.org/gsea/msigdb/index.jsp" target="_blank">GSEA官网</a>提供了GSEA分析软件和MSigDB数据库中的所有通路下载，如果需要更多的通路集可以自行下载，本包内置了MSigDB的H,C1-8的所有大类集及C2,C5的部分重要子类集，还有整理好的最新版的KEGG官方的PATHWAY通路集合。</p></li>
<li><p>本包构建了一个图形界面函数<code>runAPP_GSEA()</code>，可在安装完LZ包后直接通过运行<code>LZ::runAPP_GSEA()</code>启动图形界面，也可在浏览器中打开。详细见<a href="enrich.html#enrich-gsea-r.gsea.gui">R GSEA 图形界面</a></p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="enrich.html#cb14-1" tabindex="-1"></a><span class="fu">library</span>(LZ)</span>
<span id="cb14-2"><a href="enrich.html#cb14-2" tabindex="-1"></a><span class="fu">library</span>(clusterProfiler)</span>
<span id="cb14-3"><a href="enrich.html#cb14-3" tabindex="-1"></a><span class="fu">library</span>(enrichplot)</span>
<span id="cb14-4"><a href="enrich.html#cb14-4" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb14-5"><a href="enrich.html#cb14-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-6"><a href="enrich.html#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="enrich.html#cb14-7" tabindex="-1"></a><span class="co"># 1. Gene list 排序表</span></span>
<span id="cb14-8"><a href="enrich.html#cb14-8" tabindex="-1"></a>genelist <span class="ot">&lt;-</span> all_father<span class="sc">$</span>gsealist</span>
<span id="cb14-9"><a href="enrich.html#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="enrich.html#cb14-10" tabindex="-1"></a><span class="co"># 2. Pathway Gene Set 表</span></span>
<span id="cb14-11"><a href="enrich.html#cb14-11" tabindex="-1"></a><span class="co"># 内置数据集 gmt.largelist.23.12.Hs.symbols</span></span>
<span id="cb14-12"><a href="enrich.html#cb14-12" tabindex="-1"></a><span class="co">#   含1. msigDB数据库的全部通路大类 </span></span>
<span id="cb14-13"><a href="enrich.html#cb14-13" tabindex="-1"></a><span class="co">#     2. msigDB的C2,C5的部分子集通路[这些子集是C2,C5的一部分] </span></span>
<span id="cb14-14"><a href="enrich.html#cb14-14" tabindex="-1"></a><span class="co">#     3.最新版本的KEGG全部通路</span></span>
<span id="cb14-15"><a href="enrich.html#cb14-15" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gmt.largelist.23.12.Hs.symbols&quot;</span>)   </span>
<span id="cb14-16"><a href="enrich.html#cb14-16" tabindex="-1"></a><span class="co"># 选择KEGG通路集合，把美元符号后面字符删掉，然后按tab键可以选择其他数据集</span></span>
<span id="cb14-17"><a href="enrich.html#cb14-17" tabindex="-1"></a>gmt <span class="ot">&lt;-</span> gmt.largelist.<span class="dv">23</span>.<span class="fl">12.</span>Hs.symbols<span class="sc">$</span>kegg.all.<span class="dv">23</span>.<span class="fl">12.</span>Hs.symbols.gmt</span>
<span id="cb14-18"><a href="enrich.html#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="enrich.html#cb14-19" tabindex="-1"></a><span class="co"># 全部该GeneSet数据的通路GSEA分析  -----------</span></span>
<span id="cb14-20"><a href="enrich.html#cb14-20" tabindex="-1"></a>gsea <span class="ot">&lt;-</span> <span class="fu">DEG_runGSEA</span>(<span class="at">genelist=</span>genelist, <span class="at">gmt_set=</span>gmt, <span class="at">pic.save=</span>F)</span>
<span id="cb14-21"><a href="enrich.html#cb14-21" tabindex="-1"></a><span class="co"># 将所有的分析结果导出到本地[gsea.result]文件夹，统计总结表名为gsea_stat</span></span>
<span id="cb14-22"><a href="enrich.html#cb14-22" tabindex="-1"></a><span class="co">#   导出文件夹名和文件名均可按需修改</span></span>
<span id="cb14-23"><a href="enrich.html#cb14-23" tabindex="-1"></a><span class="fu">DEGp_GSEA_plotALL</span>(gsea, <span class="at">result_dir =</span> <span class="st">&quot;gsea.result&quot;</span>, </span>
<span id="cb14-24"><a href="enrich.html#cb14-24" tabindex="-1"></a>                  <span class="at">xl_filename =</span> <span class="st">&quot;gsea_stat&quot;</span>)</span>
<span id="cb14-25"><a href="enrich.html#cb14-25" tabindex="-1"></a></span>
<span id="cb14-26"><a href="enrich.html#cb14-26" tabindex="-1"></a><span class="co"># 单个GeneSet数据的通路GSEA分析（且从自己准备的gmt文件开始），可从MSigDB网</span></span>
<span id="cb14-27"><a href="enrich.html#cb14-27" tabindex="-1"></a><span class="co">#  站搜索下载</span></span>
<span id="cb14-28"><a href="enrich.html#cb14-28" tabindex="-1"></a><span class="co"># 设定文件路径</span></span>
<span id="cb14-29"><a href="enrich.html#cb14-29" tabindex="-1"></a>gmt_filename <span class="ot">&lt;-</span> <span class="st">&quot;D:/Team/RNAseq/data/geneset/WP_FERROPTOSIS.v2022.1.Hs.gmt&quot;</span></span>
<span id="cb14-30"><a href="enrich.html#cb14-30" tabindex="-1"></a>gmt_single <span class="ot">&lt;-</span> clusterProfiler<span class="sc">::</span><span class="fu">read.gmt</span>(gmt_filename)</span>
<span id="cb14-31"><a href="enrich.html#cb14-31" tabindex="-1"></a>gsea.single <span class="ot">&lt;-</span> <span class="fu">DEG_runGSEA</span>(<span class="at">genelist =</span> genelist, <span class="at">gmt_set =</span> gmt_single, </span>
<span id="cb14-32"><a href="enrich.html#cb14-32" tabindex="-1"></a>                           <span class="at">pic.save=</span>T, <span class="at">outdir =</span> <span class="st">&quot;./gsea.result2/&quot;</span>, </span>
<span id="cb14-33"><a href="enrich.html#cb14-33" tabindex="-1"></a>                           <span class="at">filename =</span> <span class="st">&quot;ferr&quot;</span>)</span></code></pre></div>
</div>
<div id="enrich-gsea-r.gsea.gui" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> R GSEA 图形界面<a href="enrich.html#enrich-gsea-r.gsea.gui" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>图形界面可以用自己的表格数据(上传表格不是必须，方式二启动就不需要)上传来做GSEA分析，表格必须有且仅有两列，分别为Gene列和log2FC列，具体表格形式如下：</p>
<table>
<thead>
<tr class="header">
<th align="left">Gene</th>
<th align="left">log2FC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geneA</td>
<td align="left">9.8</td>
</tr>
<tr class="even">
<td align="left">geneX</td>
<td align="left">4.3</td>
</tr>
<tr class="odd">
<td align="left">geneY</td>
<td align="left">1.2</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
</tr>
<tr class="odd">
<td align="left">geneZ</td>
<td align="left">0.3</td>
</tr>
<tr class="even">
<td align="left">geneB</td>
<td align="left">-0.8</td>
</tr>
<tr class="odd">
<td align="left">geneZ</td>
<td align="left">-5.2</td>
</tr>
</tbody>
</table>
<p>注意：虽然要求第二列名为log2FC,但第二列只要是表示变化倍数就可以，不一定要是log2后数据，没有排序也没关系。</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="enrich.html#cb15-1" tabindex="-1"></a><span class="co"># 启动方法1（不带参数启动），适合自己已经有了差异分析结果的表格的情况，</span></span>
<span id="cb15-2"><a href="enrich.html#cb15-2" tabindex="-1"></a><span class="co">#  那么运行此句后，不需要在R里写任何代码，如果通过LZ::runAPP_GSEA()甚至</span></span>
<span id="cb15-3"><a href="enrich.html#cb15-3" tabindex="-1"></a><span class="co">#  都不需要加载包。</span></span>
<span id="cb15-4"><a href="enrich.html#cb15-4" tabindex="-1"></a><span class="co">#  使用这种方法，则必须要上传上述指定的表格形式的表格后才能点击画图。</span></span>
<span id="cb15-5"><a href="enrich.html#cb15-5" tabindex="-1"></a><span class="fu">runAPP_GSEA</span>() <span class="co"># 或在安装成功LZ包后，直接通过LZ::runAPP_GSEA()来启动</span></span>
<span id="cb15-6"><a href="enrich.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="enrich.html#cb15-7" tabindex="-1"></a><span class="co"># 启动方法2（带参数启动），适合在R中已经有genelist的情况。</span></span>
<span id="cb15-8"><a href="enrich.html#cb15-8" tabindex="-1"></a><span class="co"># 已在R里有了genelist的话，运行此句启动图形界面，这样就不需要上传表格</span></span>
<span id="cb15-9"><a href="enrich.html#cb15-9" tabindex="-1"></a><span class="fu">runAPP_GSEA</span>(<span class="at">genelist =</span> genelist)</span></code></pre></div>
</div>
<div id="一些进阶操作及技巧不会没有关系不做过多解释自行体会无r语言基础者慎入" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> 一些进阶操作及技巧(不会没有关系，不做过多解释，自行体会，无R语言基础者慎入)<a href="enrich.html#一些进阶操作及技巧不会没有关系不做过多解释自行体会无r语言基础者慎入" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="enrich.html#cb16-1" tabindex="-1"></a><span class="co"># 进阶操作 ---------------------------</span></span>
<span id="cb16-2"><a href="enrich.html#cb16-2" tabindex="-1"></a><span class="co"># 1. 查找指定通路的图</span></span>
<span id="cb16-3"><a href="enrich.html#cb16-3" tabindex="-1"></a><span class="co">#  如果自己知道通路的名字，可以通过查找来定位到通路的位置，然后单独画图</span></span>
<span id="cb16-4"><a href="enrich.html#cb16-4" tabindex="-1"></a>pathway <span class="ot">=</span> <span class="st">&quot;^ABC&quot;</span></span>
<span id="cb16-5"><a href="enrich.html#cb16-5" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">grep</span>(pathway, gsea[,<span class="st">&quot;ID&quot;</span>])</span>
<span id="cb16-6"><a href="enrich.html#cb16-6" tabindex="-1"></a><span class="fu">grep</span>(pathway, gsea[,<span class="st">&quot;ID&quot;</span>], <span class="at">value =</span> T) <span class="co"># 查看找到的通路名称，必须时唯一值，否则请使用更加详细的查找条件再查找一次。</span></span>
<span id="cb16-7"><a href="enrich.html#cb16-7" tabindex="-1"></a><span class="fu">DEGp_GSEA</span>(gsea, <span class="at">num =</span> n)</span>
<span id="cb16-8"><a href="enrich.html#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="enrich.html#cb16-9" tabindex="-1"></a><span class="co"># 2. 从当前的gmt文件中获取指定的Pathway Gene set(gmt对象名一定腰围gmt才行)</span></span>
<span id="cb16-10"><a href="enrich.html#cb16-10" tabindex="-1"></a>gmtdf.find <span class="ot">&lt;-</span> <span class="fu">find_pathway</span>(<span class="st">&quot;^Ferr&quot;</span>)</span>
<span id="cb16-11"><a href="enrich.html#cb16-11" tabindex="-1"></a>gsea.single <span class="ot">&lt;-</span> <span class="fu">DEG_runGSEA</span>(<span class="at">genelist =</span> genelist, <span class="at">gmt_set=</span>gmtdf.find, </span>
<span id="cb16-12"><a href="enrich.html#cb16-12" tabindex="-1"></a>                           <span class="at">pic.save=</span>T, <span class="at">outdir =</span> <span class="st">&quot;./gsea.ytb3/&quot;</span>, </span>
<span id="cb16-13"><a href="enrich.html#cb16-13" tabindex="-1"></a>                           <span class="at">filename =</span> <span class="st">&quot;fer_taget&quot;</span>)</span>
<span id="cb16-14"><a href="enrich.html#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="enrich.html#cb16-15" tabindex="-1"></a><span class="co"># 3. 如果自己的分析中想将自己的数据转化为GSEA要求的genelist数据，</span></span>
<span id="cb16-16"><a href="enrich.html#cb16-16" tabindex="-1"></a><span class="co">#    例如自己的分析项目中有一个名为re的对象，该对象中有</span></span>
<span id="cb16-17"><a href="enrich.html#cb16-17" tabindex="-1"></a><span class="co">#    基因名列XX 和 基因变化倍数列 YY</span></span>
<span id="cb16-18"><a href="enrich.html#cb16-18" tabindex="-1"></a>genelist <span class="ot">&lt;-</span> re<span class="sc">$</span>YY</span>
<span id="cb16-19"><a href="enrich.html#cb16-19" tabindex="-1"></a><span class="fu">names</span>(genelist) <span class="ot">&lt;-</span> re<span class="sc">$</span>XX</span>
<span id="cb16-20"><a href="enrich.html#cb16-20" tabindex="-1"></a>genelist <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">sort</span>(genelist, <span class="at">decreasing =</span> T))</span>
<span id="cb16-21"><a href="enrich.html#cb16-21" tabindex="-1"></a></span>
<span id="cb16-22"><a href="enrich.html#cb16-22" tabindex="-1"></a><span class="co"># 4. GSEA图形界面中若使用结束按钮关闭程序，会将最后一次画图的数据保留在</span></span>
<span id="cb16-23"><a href="enrich.html#cb16-23" tabindex="-1"></a><span class="co">#    R会话中，具体如下：</span></span>
<span id="cb16-24"><a href="enrich.html#cb16-24" tabindex="-1"></a><span class="co"># 最后画的一幅图</span></span>
<span id="cb16-25"><a href="enrich.html#cb16-25" tabindex="-1"></a>pic_gsea</span>
<span id="cb16-26"><a href="enrich.html#cb16-26" tabindex="-1"></a><span class="co"># 保存图片</span></span>
<span id="cb16-27"><a href="enrich.html#cb16-27" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&#39;aaa.pdf&#39;</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb16-28"><a href="enrich.html#cb16-28" tabindex="-1"></a>pic_gsea</span>
<span id="cb16-29"><a href="enrich.html#cb16-29" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb16-30"><a href="enrich.html#cb16-30" tabindex="-1"></a><span class="co"># 最后一次选择的通路集详细</span></span>
<span id="cb16-31"><a href="enrich.html#cb16-31" tabindex="-1"></a>sy_gmt_taget</span>
<span id="cb16-32"><a href="enrich.html#cb16-32" tabindex="-1"></a><span class="co"># 最后一次选择的通路名称</span></span>
<span id="cb16-33"><a href="enrich.html#cb16-33" tabindex="-1"></a>sy_pathway_name</span>
<span id="cb16-34"><a href="enrich.html#cb16-34" tabindex="-1"></a><span class="co"># 最后一次选择的大类通路集详细的前六行</span></span>
<span id="cb16-35"><a href="enrich.html#cb16-35" tabindex="-1"></a>sy_gmt <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb16-36"><a href="enrich.html#cb16-36" tabindex="-1"></a></span>
<span id="cb16-37"><a href="enrich.html#cb16-37" tabindex="-1"></a><span class="co"># 5. 转换成宽型文件</span></span>
<span id="cb16-38"><a href="enrich.html#cb16-38" tabindex="-1"></a>gmt.w2 <span class="ot">&lt;-</span> <span class="fu">gmt_longTowide2</span>(gmt) </span></code></pre></div>
</div>
<div id="gsea官方软件" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> GSEA官方软件<a href="enrich.html#gsea官方软件" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>自行搜素方法，网络上有大量图文教程 …</p>
</div>
</div>
<div id="visual" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 转录组其它可视化<a href="enrich.html#visual" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On the way …</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="deg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rnaseq_new_pipeline.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": true,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["instapaper", "whatsapp", "facebook", "vk"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["LZ.pdf", "LZ.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
},
"split_by": "section"
});
});
</script>

</body>

</html>
